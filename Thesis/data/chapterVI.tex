\chapter{EXPERIMENTAL IMPLEMENTATION}
To complement the numerical findings based on our theoretical framework. We take an experimental implementation to assess two schemes proposed in this work.
The RSSI signal strength data set is collected during experiment. This information is also used to provide statistical evidence for the wireless channel model adopted
throughout. This model is used to determine the characteristics of the environment. The system is designed to work on the 2.4 $GHz$ ISM radio band which is used by Wi-Fi technology. In this experiment, all wireless clients are connected to a wireless access point.
This chapter details the way the experiments are designed, and explains the
analysis of the gathered information.

\section{Monitoring Devices}
Every sensing device takes the form of a Next Unit of Computing (NUC) by Intel{\texttrademark}, and runs on Ubuntu 14.04 operation system. Wireless monitoring is enabled through an Alfa{\texttrademark}~\texttt{AWUS036NHA} wireless interface with a detachable antenna.
The Atheros{\texttrademark} chipset is able to listen to transmission packets on a channel if turned on monitoring mode. The sub-miniature version A antenna connectors are used to attach either isotropic antennas or directional antennas. Each monitoring device is attached with one directional antenna and one isotropic antenna. Wooden sticks are also used to fix the two antennas attached to one monitoring devices at different heights in order to reduce the interference influence between two antennas. The radiation pattern of directional antenna is shown in Fig. \ref{figure:Directionalantenna}.
\begin{figure}[t]
	\centerline{\input{Figures/Directionalantenna}}
	\caption{This graph depicts directional antenna radiation patterns}
	\label{figure:Directionalantenna}
\end{figure}
A sniffing software build on the $pcap$ application programming interface captures and filters wireless packets.
For filtering, we employ a hash table for removing the duplicates in the detected MAC addresses. 
The software creates a local database to store MAC address and RSSI extracted from the wireless packets it receives. Finally the local database is sent to a central server for processing.
\begin{figure}[]
	\centering
	\includegraphics[scale=0.5]{Figures/DeviceSetup.jpg}
	\caption{This graph shows the monitoring device we use. }
	\label{figure: Device}
\end{figure}
The monitoring device we used during experiment is shown in Fig. \ref{figure: Device}.

\section{Wireless client}
In our experiment, the wireless clients are Android{\texttrademark} smartphones. All the wireless clients connect to a same local access point and send packets periodically which makes them detected by sniffing software. For the purpose of evaluate the performance of estimator, not only we need RSSI values, but we also need the ground truth (i.e. the location of the wireless clients). Thus we employ a custom app, which logs GPS coordinates and time. While conducting experiment, wireless clients periodically transmit the GPS information collected by app to a central server. MAC addresses and time stamps are then used to match locations to power vectors at the center server, yielding a data set for performance evaluation.

\section{Experimental Samples}
The experimental samples are divided into two categories, one is for monitoring devices with isotropic antennas, the other is for monitoring devices with directional antennas. Each category contains about 400 power and location vectors. Each power vector is in this form, $\underline{\mathbf{p}} = (\mathbf{p}_1, \ldots, \mathbf{p}_{4})$, where $\mathbf{p}_i$ is the power received by $i$ monitoring device. Since there are four monitoring devices, we have almost 3200 distinct points of RSSI. For conduct experimental trail as following. Firstly, generate the number of active clients inside $\r_{t}$ and number of active clients outside $\r_{o}$ according to two Poisson distribution with parameter $\lambda_{t}$ and $\lambda_[o]$ respectively. 
\begin{xalignat*}{2}
	\lambda_{\mathrm{t}}
	&= \alpha \frac{\lambda}{A_{\mathrm{t}}}
	&\lambda_{\mathrm{o}}
	&= (1 - \alpha) \frac{\lambda}{A_{\mathrm{o}}} .
\end{xalignat*}
Then $r_{t}$ entries are selected uniformly from clients in $A_{t}$, and $r_{o}$ entries are selected uniformly from clients in $A_{o}$. The two collections of entries are combined into a single vector $\underline{\mathbf{p}}$, which is the input to the estimator. At last, the estimates are evaluated through the ground truth.

\section{Channel Parameters}
Channel parameters $A$ and $B$ can vary depending on the wireless environment. This experiment is conducted on widely open parking lot. Fig.  offers a satellite image view of the experiment site.
The parameters are obtained by using least squares method mentioned in \ref{section:channel}. The parameters for the isotropic systems are $A = -41.68, B = -16.07$ and $\sigma_{s} = 7.91 dBm$. Similarly, the parameters for the systems with directional antennas are $A = -34.72, B = -17.11$ and $\sigma_{s} = 8.31 dBm$
\begin{figure}[]
	\centering
	\includegraphics[scale=1]{Figures/Googlemap.png}
	\caption{This figure highlights the site used for the experiments and marks locations of experiment data. }
	\label{figure: Googlemap}
\end{figure}

\section{Experiment Results}
\subsection{Performance of Bayes Estimation}
Experimental curves under Bayes estimation scheme is shown in Fig. \ref{figure: bayesex}. The horizontal axis is the splitting parameter $\alpha$. The vertical axis is the BMSE. Each point is averaging over 10000 trails.
\begin{figure}[]
	\centering
	\includegraphics[scale=0.5]{Figures/bayesex.png}
	\caption{This figure depicts the experimental Bayesian mean squared error as function of Poisson splitting coefficient $\alpha$. Red line represents systems with directional antennas, whereas black line represent system with isotropic antennas. }
	\label{figure: bayesex}
\end{figure}
The confidence intervals of $|r_{t}-\hat{r_{t}}|$ corresponding to isotropic antennas and directional antennas are summarized in Table \ref{table:ConfidenceBayesex}.
\begin{table}[bht]
	\caption{Confidence interval of $|r_{t}-\hat{r_{t}}|$ for experimental Bayes scheme} \label{table:ConfidenceBayesex}
	\centerline{
		\begin{tabular}{|l|l|c|}
			\hline
			\multicolumn{1}{|c|}{\textbf{Antenna type}} &
			\multicolumn{1}{|c|}{\textbf{Confidence interval}} &
			\multicolumn{1}{|c|}{\textbf{Confidence level}} \\
			\hline
			Directional & $3.317535 \pm 0.010430$& 95\% \\
			\hline
			Isotropic & $3.331094 \pm 0.010274$ & 95\% \\
			\hline
		\end{tabular}}
	\end{table}
The approximation probability density functions corresponding to systems with directional antennas and isotropic antennas are shown in Fig. \ref{figure: bayesdirex} and Fig. \ref{figure: bayesomniex}.
\begin{figure}[]
	\centering
	\includegraphics[scale=0.5]{Figures/bayesdirex.png}
	\caption{This graph shows the approximation probability density function of $|r_{t}-\hat{r_{t}}|$ corresponding to system equipped with directional antennas under scheme of \ref{section:BayesEstimation}. }
	\label{figure: bayesdirex}
\end{figure}
\begin{figure}[]
	\centering
	\includegraphics[scale=0.5]{Figures/bayesomniex.png}
	\caption{This graph shows the approximation probability density function of $|r_{t}-\hat{r_{t}}|$ corresponding to system equipped with isotropic antennas under scheme of \ref{section:BayesEstimation}. }
	\label{figure: bayesomniex}
\end{figure}
In this case using directional antennas does not bring an obvious benefit. The BMSE of systems with directional antennas and that with isotropic antennas are very close. As well as the confidence intervals and the absolute error distribution. This phenomena maybe caused by the inaccuracy of GPS information. Some small location errors may bring large errors, especially for the case when using directional antennas. 
\subsection{Performance of Maximum Estimation}
Experimental curves under Bayes estimation scheme is shown in Fig. \ref{figure: maxRTex}. The horizontal axis is the splitting parameter $\alpha$. The vertical axis is the BMSE. Each point is averaging over 10000 trails.
\begin{figure}[]
	\centering
	\includegraphics[scale=0.5]{Figures/maxRTex.png}
	\caption{This figure depicts the experimental Bayesian mean squared error as function of Poisson splitting coefficient $\alpha$. Red line represents systems with directional antennas, whereas black line represent system with isotropic antennas. }
	\label{figure: maxRTex}
\end{figure}
The confidence intervals of $|r_{t}-\hat{r_{t}}|$ corresponding to isotropic antennas and directional antennas are summarized in Table \ref{table:Confidencemaxex}.
\begin{table}[bht]
	\caption{Confidence interval of $|r_{t}-\hat{r_{t}}|$ for experimental Maximum estimation scheme} \label{table:Confidencemaxex}
	\centerline{
		\begin{tabular}{|l|l|c|}
			\hline
			\multicolumn{1}{|c|}{\textbf{Antenna type}} &
			\multicolumn{1}{|c|}{\textbf{Confidence interval}}&
			\multicolumn{1}{|c|}{\textbf{Confidence level}} \\
			\hline
			Directional & $5.881027 \pm 0.016484$ &95\% \\
			\hline
			Isotropic & $7.144900 \pm 0.019182$ &95\% \\
			\hline
		\end{tabular}}
	\end{table}
	The approximation probability density functions corresponding to systems with directional antennas and isotropic antennas are shown in Fig. \ref{figure: maxdirex} and Fig. \ref{figure: maxomniex}.
	\begin{figure}[]
		\centering
		\includegraphics[scale=0.5]{Figures/maxdirex.png}
		\caption{This graph shows the approximation probability density function of $|r_{t}-\hat{r_{t}}|$ corresponding to system equipped with directional antennas under scheme of \ref{section:Maxestimation}. }
		\label{figure: maxdirex}
	\end{figure}
	\begin{figure}[]
		\centering
		\includegraphics[scale=0.5]{Figures/maxomniex.png}
		\caption{This graph shows the approximation probability density function of $|r_{t}-\hat{r_{t}}|$ corresponding to system equipped with isotropic antennas under scheme of \ref{section:Maxestimation}. }
		\label{figure: maxomniex}
	\end{figure}
In this case, systems with directional antennas better, which means systems equipped with direcional antennas are more discrimination.